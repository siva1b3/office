# ----------------------------
# PgAdmin Secret
# ----------------------------
apiVersion: v1
kind: Secret
metadata:
  name: pgadmin-secret
type: Opaque
stringData:
  PGADMIN_DEFAULT_EMAIL: admin@admin.com
  PGADMIN_DEFAULT_PASSWORD: admin123

---
# ----------------------------
# PgAdmin Service
# ----------------------------
apiVersion: v1
kind: Service
metadata:
  name: pgadmin-service
spec:
  type: NodePort
  selector:
    app: pgadmin
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80
      nodePort: 30080 # Accessible on <your-node-ip>:30080

---
# ----------------------------
# PgAdmin Pod with Resource Limits
# ----------------------------
apiVersion: v1
kind: Pod
metadata:
  name: pgadmin
  labels:
    app: pgadmin
spec:
  containers:
    - name: pgadmin
      image: dpage/pgadmin4:latest
      ports:
        - containerPort: 80
      env:
        - name: PGADMIN_DEFAULT_EMAIL
          valueFrom:
            secretKeyRef:
              name: pgadmin-secret
              key: PGADMIN_DEFAULT_EMAIL
        - name: PGADMIN_DEFAULT_PASSWORD
          valueFrom:
            secretKeyRef:
              name: pgadmin-secret
              key: PGADMIN_DEFAULT_PASSWORD
      resources: # âœ… Added resource constraints
        requests:
          memory: "512Mi" # Guaranteed memory allocation
          cpu: "250m" # Guaranteed CPU allocation (0.25 core)
        limits:
          memory: "1Gi" # Max memory usage
          cpu: "500m" # Max CPU usage (0.5 core)
